---
layout: post
title: "Preparing for Influenza Season - Forecasting staffing needs "
subtitle: "Tools: Excel (Pivot, VLOOKUP, Integration etc.), Tableau"
date: 2023-10-21 10:45:13 -0400
background: '/img/posts/influenza_tired_nurse.jpeg'
image_url: '/img/maintenance-2422173_1280.png'
---

<h2 class="section-heading">Introduction & Objectives</h2>

<p style="text-align: justify;">Every year there is an influenza season, identified with a spike in the number of influenza infections and resulting hospitalisations.</p>

<p style="text-align: justify;">I was asked to analyse historical data, to forecast staffing needs for a medical staffing agency, which provides temporary workers to clinics and hospitals on an as-needed basis across the USA.</p>

<p style="text-align: justify;">It began with drawing business requirements from stakeholder meetings, pointing to areas of concern and ideas for the analysis itself.</p>

<p><b>Tools:</b>
    <ul>
        <li>Excel (Pivot, VLOOKUP, Integration)</li>
        <li>Tableau Public for visualizations</li>
    </ul>
</p>

<p><b>Data:</b>
    <ul>
        <li>Open source data</li>
        <li>4 Possible Data sets</li>
    </ul>
</p>

<h2 class="section-heading">Step 1: Data Selection</h2>

<p style="text-align: justify;">After drawing of requirements from the stakeholders, it was time to evaluate each data set. I conidered the source of data, its reliability, ownership and ethical concerns (since I am using some medical data, this is important).</p>

<p style="text-align: justify;">Because my focus was on sending the staff to those states which will experience the greatest need I focused not on reported influenza cases but on actual deaths related to influenza. </p>

<p style="text-align: justify;">From 4 possible datasets I chose to use:
    <ol>
        <li>US Census Data by Geography</li>
        <li>US Influenza Deaths</li>
    </ol>
</p>


<h2 class="section-heading">Step 2: Cleaning & Consistency Checks</h2>

<p style="text-align: justify;">I inspected the data in Excel. I discovered that there naming inconcistencies which I corrected and also regions (like in Puerto Rico) which are not within the US, which I eliminated from the data set.</p>

<p style="text-align: justify;">Where there were missing values or names, I inserted averages, modal values. Now that the dat was cleaned and workeable  could proceed with the next step.</p>


<h2 class="section-heading">Step 3: Integration</h2>

<p style="text-align: justify;">To be able to use a data set for analysis one must often integrate/ merge data using some common key or variable. This is because we seldom find a complete data set which is ready for use as is. This is what this step was about.</p>

<p style="text-align: justify;">I began by mapping the data, trying to find commonalities between the two data sets. I identified 'state' and year as common columns. But the US Census data had records for each county in each state, whereas the Influenza Deaths data was only for each state. This was a 'granularity' issue.</p>

<img style="float: left; margin-right: 15px; width: 400px; height: auto; border: 5px solid #555" class="img-fluid" src="/img/posts/influenza_pivot_deaths.png" alt="Excerpt of spreadsheet showing pivot table">

<p style="overflow: hidden; text-align: justify;">I created a pivot table for the US Census data, which summed up the records for each state. Knowing that I would perform hypothesis testing, I preemptively grouped deaths and popuations into 65+ and < 65 years of age.</p>

<p style="overflow: hidden; text-align: justify;">Now the data was ready for integration. So I used a VLOOKUP to integrate the data sets into one.</p>

<br>
<img style="width: 400px; height: auto; border: 5px solid #555" class="img-fluid" src="/img/posts/influenza_new_data_vlookup.png" alt="Excerpt of spreadsheet showing VLOOKUP">
<br>

<p style="overflow: hidden; text-align: justify;">Finally I added new columns, where I used  simple formulas to calculate the mortality rates for each of the two age groupings ( under and over 65). This would play a role in the next step of the analysis.</p>

<h2 class="section-heading">Step 4: Statistical Analysis & Testing</h2>

<p style="text-align: center;"><b>H0:    µInfluenza mortality 65+ years = µInfluenza mortality <65 years</b></p>
<p style="text-align: center;"><b>HA:    µInfluenza mortality 65+ years <> µInfluenza mortality <65 years</b></p>

<p style="text-align: justify;">The null and alternative hypothesis are stated above. I was trying to test whether the two groups had the same risk of death/hospitalisation from influenza. This was a two-tailed test, because I was interested in knowing whether the average mortality rate is higher or lower for those in the age group 65+.</p>

<img style="float: left; margin-right: 15px; width: 400px; height: auto; border: 5px solid #555" class="img-fluid" src="/img/posts/influenza_stats_test.png" alt="Excerpt showing t-test">

<p style="text-align: justify;">The test produced a result with a p-value= 1,50E-171 (rounded). The p-value is much lower than the alpha. This means the groups are significantly different.</p>

<p style="text-align: justify;">The null hypothesis was rejected. At a 95% confidence level I found significant differences between the average Influenza mortality rates for those aged  <65 years and those  65+ years of age. Because of this strong result, I continued my analysis to identify <b>where</b> the age group of people 65 and above are a higher proportion of total poulation.</p>

<img style="float: right; margin-left: 15px; width: 400px; height: auto; border: 5px solid #555" class="img-fluid" src="/img/posts/influenza_scatter_mortality_ages.png" alt="Scatterplot for mortality rates">
<span class="caption text-muted">Even the mortality rates have little positive correlation</span>

<h2 class="section-heading">Step 5: Visual Analysis</h2>

<img style="float: left; margin-right: 15px; width: 400px; height: auto; border: 5px solid #555" class="img-fluid" src="/img/posts/influenza_stats_test.png" alt="Temporal chart for Influenza deaths">

<p style="text-align: justify;">The objective of the project was to create recommendations for the allocation of temporary staff. This means placing them at the right time and with focus on priority areas. I grouped the 50 US states into their geographic areas and performed a temporal analysis with the aid of Tableau. The results were clear. The number of influenza deaths increases rapidly in December and spikes in January.</p>

<img style="float: right; margin-left: 15px; width: 400px; height: auto; border: 5px solid #555" class="img-fluid" src="/img/posts/influenza_map_deaths.png" alt="Chlorpleth and sybol maps">

<p style="text-align: justify;">I created a variety of charts but I chose a chloropleth map with symbols in this case study (you can see the full storyboard on Tableau). The darker the blue, the greater the number of influenza deaths. The greater the circle in the state, the larger the total population of the state, and the lighter the circle, the greater the number of influenza deaths for age group 65+. We now had our 'hot zones'.</p>

<h2 class="section-heading">Step 6: Recommendations</h2>

<p><b>Priority states (excerpt):</b>
    <ul>
        <li>California</li>
        <li>New York</li>
        <li>Texas</li>
        <li>Pennsylvania</li>
        <li>Florida</li>
        <li>Illinois</li>
        <li>Ohio</li>
        <li>North Carolina</li>
        <li>Michigan</li>
    </ul>
</p>

<p style="text-align: justify;">It was lso recommended that staff be deployed latest November, so that the swell of patients will not immediately overwhelm staff. Additionally, staff should be vaccinated as this limited abseenteism and gave greater confidence to staff.</p>


<a href="https://github.com/mngunizulu/Data-Analysis-Portfolio/blob/main/Portfolio%20Projects/Preparing%20for%20Influenza%20Season/Preparing%20for%20Influenza%20Season.zip" class="btn btn-primary" download>Download Project Folder</a>


<p>Placeholder text by <a href="https://mngunizulu.github.io/">Mnguni Zulu</a>. Photographs by <a href="https://mngunizulu.github.io/">Mnguni Zulu</a>.</p>