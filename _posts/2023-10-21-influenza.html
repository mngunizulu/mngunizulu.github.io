---
layout: post
title: "Preparing for Influenza Season - Forecasting staffing needs "
subtitle: "Tools: Excel (Pivot, VLOOKUP, Integration etc.), Tableau"
date: 2023-10-21 10:45:13 -0400
background: '/img/posts/influenza_tired_nurse.jpeg'
image_url: '/img/maintenance-2422173_1280.png'
---

<h2 class="section-heading">Introduction & Objectives</h2>

<p style="text-align: justify;">Every year there is an influenza season, identified with a spike in the number of influenza infections and resulting hospitalisations.</p>

<p style="text-align: justify;">I was asked to analyse historical data, to forecast staffing needs for a medical staffing agency, which provides temporary workers to clinics and hospitals on an as-needed basis across the USA.</p>

<p style="text-align: justify;">It began with drawing business requirements from stakeholder meetings, pointing to areas of concern and ideas for the analysis itself.</p>

<p><b>Tools:</b>
    <ul>
        <li>Excel (Pivot, VLOOKUP, Integration)</li>
        <li>Tableau Public for visualizations</li>
    </ul>
</p>

<p><b>Data:</b>
    <ul>
        <li>Open source data</li>
        <li>4 Possible Data sets</li>
    </ul>
</p>

<h2 class="section-heading">Step 1: Data Selection</h2>

<p style="text-align: justify;">After drawing of requirements from the stakeholders, it was time to evaluate each data set. I conidered the source of data, its reliability, ownership and ethical concerns (since I am using some medical data, this is important).</p>

<p style="text-align: justify;">Because my focus was on sending the staff to those states which will experience the greatest need I focused not on reported influenza cases but on actual deaths related to influenza. </p>

<p style="text-align: justify;">From 4 possible datasets I chose to use:
    <ol>
        <li>US Census Data by Geography</li>
        <li>US Influenza Deaths</li>
    </ol>
</p>


<h2 class="section-heading">Step 2: Cleaning & Consistency Checks</h2>

<p style="text-align: justify;">I inspected the data in Excel. I discovered that there naming inconcistencies which I corrected and also regions (like in Puerto Rico) which are not within the US, which I eliminated from the data set.</p>

<p style="text-align: justify;">Where there were missing values or names, I inserted averages, modal values. Now that the dat was cleaned and workeable  could proceed with the next step.</p>


<h2 class="section-heading">Step 3: Integration</h2>

<p style="text-align: justify;">To be able to use a data set for analysis one must often integrate/ merge data using some common key or variable. This is because we seldom find a complete data set which is ready for use as is. This is what this step was about.</p>

<p style="text-align: justify;">I began by mapping the data, trying to find commonalities between the two data sets. I identified 'state' and year as common columns. But the US Census data had records for each county in each state, whereas the Influenza Deaths data was only for each state. This was a 'granularity' issue.</p>

<img style="float: left; margin-right: 15px; width: 400px; height: auto; border: 5px solid #555" class="img-fluid" src="/img/posts/influenza_pivot_deaths.png" alt="Excerpt of spreadsheet showing pivot table">

<p style="overflow: hidden; text-align: justify;">I created a pivot table for the US Census data, which summed up the records for each state. Knowing that I would perform hypothesis testing, I preemptively grouped deaths and popuations into 65+ and < 65 years of age.</p>

<p style="overflow: hidden; text-align: justify;">Now the data was ready for integration. So I used a VLOOKUP to integrate the data sets into one.</p>

<br>
<img style="width: 400px; height: auto; border: 5px solid #555" class="img-fluid" src="/img/posts/influenza_new_data_vlookup.png" alt="Excerpt of spreadsheet showing VLOOKUP">
<br>

<p style="overflow: hidden; text-align: justify;">Finally I added new columns, where I used  simple formulas to calculate the mortality rates for each of the two age groupings ( under and over 65). This would play a role in the next step of the analysis.</p>

<h2 class="section-heading">Step 4: Statistical Analysis & Testing</h2>

<p style="text-align: center;">H0:    µInfluenza mortality 65+ years = µInfluenza mortality <65 years </p>
<p style="text-align: center;">HA:    µInfluenza mortality 65+ years <> µInfluenza mortality <65 years </p>

<p style="text-align: justify;">The null and alternative hypothesis are stated above. I was trying to test whether the two groups had the same risk of death/hospitalisation from influenza. This will be a two-tailed test, because we interested in knowing whether the average mortality rate is higher or lower for those in the age group 65+.</p>

<p style="text-align: justify;">The test produced a result with a p-value= 1,50E-171. The p-value is much lower than the alpha. This means the groups are significantly different.</p>

<img style="float: left; margin-right: 15px; width: 400px; height: auto; border: 5px solid #555" class="img-fluid" src="/img/posts/influenza_pivot_deaths.png" alt="Excerpt showing t-test">

<p style="text-align: justify;">The null hypothesis can be rejected. At a 95% confidence level I found significant differences between the average Influenza mortality rates for those aged  <65 years of age and those  65+ years of age. Because of this strong result, I continued my analysis to identify where the age group of people 65 and above are a higher proportion of total poulation.</p>
<p style="text-align: justify;"></p>
<p style="text-align: justify;"></p>

